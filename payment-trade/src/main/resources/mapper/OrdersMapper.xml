<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.payment.trade.dao.OrdersMapper">
    <resultMap id="BaseResultMap" type="com.payment.common.entity.Orders">
        <id column="id" property="id" jdbcType="VARCHAR"/>
        <result column="trade_type" property="tradeType" jdbcType="TINYINT"/>
        <result column="trade_direction" property="tradeDirection" jdbcType="TINYINT"/>
        <result column="institution_code" property="institutionCode" jdbcType="VARCHAR"/>
        <result column="report_number" property="reportNumber" jdbcType="VARCHAR"/>
        <result column="institution_name" property="institutionName" jdbcType="VARCHAR"/>
        <result column="second_institution_name" property="secondInstitutionName" jdbcType="VARCHAR"/>
        <result column="second_institution_code" property="secondInstitutionCode" jdbcType="VARCHAR"/>
        <result column="institution_order_time" property="institutionOrderTime" jdbcType="TIMESTAMP"/>
        <result column="institution_order_id" property="institutionOrderId" jdbcType="VARCHAR"/>
        <result column="language" property="language" jdbcType="VARCHAR"/>
        <result column="return_url" property="returnUrl" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="DECIMAL"/>
        <result column="order_currency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="commodity_name" property="commodityName" jdbcType="VARCHAR"/>
        <result column="product_code" property="productCode" jdbcType="INTEGER"/>
        <result column="product_name" property="productName" jdbcType="VARCHAR"/>
        <result column="channel_code" property="channelCode" jdbcType="VARCHAR"/>
        <result column="channel_name" property="channelName" jdbcType="VARCHAR"/>
        <result column="device_code" property="deviceCode" jdbcType="VARCHAR"/>
        <result column="device_operator" property="deviceOperator" jdbcType="VARCHAR"/>
        <result column="exchange_rate" property="exchangeRate" jdbcType="DECIMAL"/>
        <result column="exchange_time" property="exchangeTime" jdbcType="TIMESTAMP"/>
        <result column="exchange_status" property="exchangeStatus" jdbcType="TINYINT"/>
        <result column="trade_currency" property="tradeCurrency" jdbcType="VARCHAR"/>
        <result column="trade_amount" property="tradeAmount" jdbcType="DECIMAL"/>
        <result column="trade_status" property="tradeStatus" jdbcType="TINYINT"/>
        <result column="refund_status" property="refundStatus" jdbcType="TINYINT"/>
        <result column="cancel_status" property="cancelStatus" jdbcType="TINYINT"/>
        <result column="clear_status" property="clearStatus" jdbcType="TINYINT"/>
        <result column="settle_status" property="settleStatus" jdbcType="TINYINT"/>
        <result column="channel_number" property="channelNumber" jdbcType="VARCHAR"/>
        <result column="rate_type" property="rateType" jdbcType="VARCHAR"/>
        <result column="rate" property="rate" jdbcType="DECIMAL"/>
        <result column="fee" property="fee" jdbcType="DECIMAL"/>
        <result column="fee_payer" property="feePayer" jdbcType="VARCHAR"/>
        <result column="charge_status" property="chargeStatus" jdbcType="TINYINT"/>
        <result column="charge_time" property="chargeTime" jdbcType="TIMESTAMP"/>
        <result column="pay_method" property="payMethod" jdbcType="VARCHAR"/>
        <result column="req_ip" property="reqIp" jdbcType="VARCHAR"/>
        <result column="report_channel_time" property="reportChannelTime" jdbcType="TIMESTAMP"/>
        <result column="channel_callback_time" property="channelCallbackTime" jdbcType="TIMESTAMP"/>
        <result column="float_rate" property="floatRate" jdbcType="DECIMAL"/>
        <result column="add_value" property="addValue" jdbcType="DECIMAL"/>
        <result column="goods_description" property="goodsDescription" jdbcType="VARCHAR"/>
        <result column="drawee_name" property="draweeName" jdbcType="VARCHAR"/>
        <result column="drawee_account" property="draweeAccount" jdbcType="VARCHAR"/>
        <result column="drawee_bank" property="draweeBank" jdbcType="VARCHAR"/>
        <result column="drawee_email" property="draweeEmail" jdbcType="VARCHAR"/>
        <result column="drawee_phone" property="draweePhone" jdbcType="VARCHAR"/>
        <result column="sign" property="sign" jdbcType="VARCHAR"/>
        <result column="remark1" property="remark1" jdbcType="VARCHAR"/>
        <result column="remark2" property="remark2" jdbcType="VARCHAR"/>
        <result column="remark3" property="remark3" jdbcType="VARCHAR"/>
        <result column="remark4" property="remark4" jdbcType="VARCHAR"/>
        <result column="jump_url" property="jumpUrl" jdbcType="VARCHAR"/>
        <result column="bank_name" property="bankName" jdbcType="VARCHAR"/>
        <result column="channel_fee" property="channelFee" jdbcType="DECIMAL"/>
        <result column="channel_rate" property="channelRate" jdbcType="DECIMAL"/>
        <result column="channel_fee_type" property="channelFeeType" jdbcType="VARCHAR"/>
        <result column="channel_gateway_rate" property="channelGatewayRate" jdbcType="DECIMAL"/>
        <result column="channel_gateway_fee" property="channelGatewayFee" jdbcType="DECIMAL"/>
        <result column="channel_gateway_fee_type" property="channelGatewayFeeType" jdbcType="VARCHAR"/>
        <result column="channel_gateway_charge" property="channelGatewayCharge" jdbcType="TINYINT"/>
        <result column="channel_gateway_status" property="channelGatewayStatus" jdbcType="TINYINT"/>
        <result column="product_settle_cycle" property="productSettleCycle" jdbcType="VARCHAR"/>
        <result column="issuer_id" property="issuerId" jdbcType="VARCHAR"/>
        <result column="up_channel_fee" property="upChannelFee" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="update_time" property="updateTime" jdbcType="TIMESTAMP"/>
        <result column="creator" property="creator" jdbcType="VARCHAR"/>
        <result column="modifier" property="modifier" jdbcType="VARCHAR"/>
        <result column="remark" property="remark" jdbcType="VARCHAR"/>
        <result column="agency_code" property="agencyCode" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="OrderRefundMap" type="com.payment.common.entity.OrderRefund">
        <id column="id" property="id" jdbcType="VARCHAR"/>
        <result column="refund_type" property="refundType" jdbcType="TINYINT"/>
        <result column="refund_mode" property="refundMode" jdbcType="TINYINT"/>
        <result column="refund_status" property="refundStatus" jdbcType="TINYINT"/>
        <result column="trade_type" property="tradeType" jdbcType="TINYINT"/>
        <result column="trade_direction" property="tradeDirection" jdbcType="TINYINT"/>
        <result column="institution_code" property="institutionCode" jdbcType="VARCHAR"/>
        <result column="institution_name" property="institutionName" jdbcType="VARCHAR"/>
        <result column="second_institution_name" property="secondInstitutionName" jdbcType="VARCHAR"/>
        <result column="second_institution_code" property="secondInstitutionCode" jdbcType="VARCHAR"/>
        <result column="institution_order_time" property="institutionOrderTime" jdbcType="TIMESTAMP"/>
        <result column="language" property="language" jdbcType="VARCHAR"/>
        <result column="institution_order_id" property="institutionOrderId" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="DECIMAL"/>
        <result column="order_currency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="commodity_name" property="commodityName" jdbcType="VARCHAR"/>
        <result column="product_code" property="productCode" jdbcType="INTEGER"/>
        <result column="channel_name" property="channelName" jdbcType="VARCHAR"/>
        <result column="channel_code" property="channelCode" jdbcType="VARCHAR"/>
        <result column="product_name" property="productName" jdbcType="VARCHAR"/>
        <result column="device_code" property="deviceCode" jdbcType="VARCHAR"/>
        <result column="device_operator" property="deviceOperator" jdbcType="VARCHAR"/>
        <result column="exchange_rate" property="exchangeRate" jdbcType="DECIMAL"/>
        <result column="exchange_time" property="exchangeTime" jdbcType="TIMESTAMP"/>
        <result column="exchange_status" property="exchangeStatus" jdbcType="TINYINT"/>
        <result column="trade_currency" property="tradeCurrency" jdbcType="VARCHAR"/>
        <result column="trade_amount" property="tradeAmount" jdbcType="DECIMAL"/>
        <result column="order_id" property="orderId" jdbcType="VARCHAR"/>
        <result column="channel_number" property="channelNumber" jdbcType="VARCHAR"/>
        <result column="pay_method" property="payMethod" jdbcType="VARCHAR"/>
        <result column="req_ip" property="reqIp" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="update_time" property="updateTime" jdbcType="TIMESTAMP"/>
        <result column="creator" property="creator" jdbcType="VARCHAR"/>
        <result column="modifier" property="modifier" jdbcType="VARCHAR"/>
        <result column="remark" property="remark" jdbcType="VARCHAR"/>
    </resultMap>


    <resultMap id="TradeDetailMap" type="com.payment.trade.vo.TradeDetailVO">
        <id column="id" property="id" jdbcType="VARCHAR"/>
        <result column="institution_order_id" property="institutionOrderId" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="DECIMAL"/>
        <result column="order_currency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="product_name" property="productName" jdbcType="VARCHAR"/>
        <result column="channel_name" property="channelName" jdbcType="VARCHAR"/>
        <result column="device_code" property="deviceCode" jdbcType="VARCHAR"/>
        <result column="device_operator" property="deviceOperator" jdbcType="VARCHAR"/>
        <result column="exchange_rate" property="exchangeRate" jdbcType="DECIMAL"/>
        <result column="exchange_time" property="exchangeTime" jdbcType="TIMESTAMP"/>
        <result column="exchange_status" property="exchangeStatus" jdbcType="TINYINT"/>
        <result column="trade_currency" property="tradeCurrency" jdbcType="VARCHAR"/>
        <result column="trade_amount" property="tradeAmount" jdbcType="DECIMAL"/>
        <result column="bank_name" property="bankName" jdbcType="VARCHAR"/>
        <result column="trade_status" property="tradeStatus" jdbcType="TINYINT"/>
        <result column="channel_number" property="channelNumber" jdbcType="VARCHAR"/>
        <result column="issuer_id" property="issuerId" jdbcType="VARCHAR"/>
        <result column="rate_type" property="rateType" jdbcType="VARCHAR"/>
        <result column="fee" property="fee" jdbcType="DECIMAL"/>
        <result column="fee_payer" property="feePayer" jdbcType="VARCHAR"/>
        <result column="req_ip" property="reqIp" jdbcType="VARCHAR"/>
        <result column="report_channel_time" property="reportChannelTime" jdbcType="TIMESTAMP"/>
        <result column="channel_callback_time" property="channelCallbackTime" jdbcType="TIMESTAMP"/>
        <result column="float_rate" property="floatRate" jdbcType="DECIMAL"/>
        <result column="add_value" property="addValue" jdbcType="DECIMAL"/>
        <result column="drawee_name" property="draweeName" jdbcType="VARCHAR"/>
        <result column="drawee_account" property="draweeAccount" jdbcType="VARCHAR"/>
        <result column="drawee_bank" property="draweeBank" jdbcType="VARCHAR"/>
        <result column="drawee_email" property="draweeEmail" jdbcType="VARCHAR"/>
        <result column="remark1" property="remark1" jdbcType="VARCHAR"/>
        <result column="remark2" property="remark2" jdbcType="VARCHAR"/>
        <result column="remark3" property="remark3" jdbcType="VARCHAR"/>
        <result column="remark4" property="remark4" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="remark" property="remark" jdbcType="VARCHAR"/>
        <result column="d_name" property="dName" jdbcType="VARCHAR"/>
        <association property="orderRefundVO" javaType="com.payment.trade.vo.OrderRefundVO">
            <id column="ore_id" property="id" jdbcType="VARCHAR"/>
            <result column="ore_refund_status" property="refundStatus" jdbcType="TINYINT"/>
            <result column="ore_amount" property="amount" jdbcType="DECIMAL"/>
            <result column="ore_channel_name" property="channelName" jdbcType="VARCHAR"/>
            <result column="ore_exchange_rate" property="exchangeRate" jdbcType="DECIMAL"/>
            <result column="ore_trade_currency" property="tradeCurrency" jdbcType="VARCHAR"/>
            <result column="ore_trade_amount" property="tradeAmount" jdbcType="DECIMAL"/>
            <result column="ore_create_time" property="createTime" jdbcType="TIMESTAMP"/>
            <result column="ore_update_time" property="updateTime" jdbcType="TIMESTAMP"/>
            <result column="ore_remark" property="remark" jdbcType="VARCHAR"/>
        </association>
        <association property="orderLogisticsVO" javaType="com.payment.trade.vo.OrderLogisticsVO">
            <id column="ol_id" property="id" jdbcType="VARCHAR"/>
            <result column="ol_reference_no" property="referenceNo" jdbcType="VARCHAR"/>
            <result column="ol_institution_code" property="institutionCode" jdbcType="VARCHAR"/>
            <result column="ol_institution_name" property="institutionName" jdbcType="VARCHAR"/>
            <result column="ol_institution_order_id" property="institutionOrderId" jdbcType="VARCHAR"/>
            <result column="ol_product_description" property="productDescription" jdbcType="VARCHAR"/>
            <result column="ol_invoice_no" property="invoiceNo" jdbcType="VARCHAR"/>
            <result column="ol_provider_name" property="providerName" jdbcType="VARCHAR"/>
            <result column="ol_payer_address" property="payerAddress" jdbcType="VARCHAR"/>
            <result column="ol_payer_name" property="payerName" jdbcType="VARCHAR"/>
            <result column="ol_payer_email" property="payerEmail" jdbcType="VARCHAR"/>
            <result column="ol_delivery_status" property="deliveryStatus" jdbcType="TINYINT"/>
            <result column="ol_received_status" property="receivedStatus" jdbcType="TINYINT"/>
            <result column="ol_create_time" property="createTime" jdbcType="TIMESTAMP"/>
            <result column="ol_update_time" property="updateTime" jdbcType="TIMESTAMP"/>
            <result column="ol_creator" property="creator" jdbcType="VARCHAR"/>
            <result column="ol_modifier" property="modifier" jdbcType="VARCHAR"/>
            <result column="ol_remark" property="remark" jdbcType="VARCHAR"/>
        </association>
    </resultMap>


    <resultMap id="OrdersVOMap" type="com.payment.trade.vo.OrdersVO">
        <result column="institutionCode" property="institutionCode" jdbcType="VARCHAR"/>
        <result column="institutionOrderId" property="institutionOrderId" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="DECIMAL"/>
        <result column="orderCurrency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="tradeStatus" property="tradeStatus" jdbcType="TINYINT"/>
        <result column="refundStatus" property="refundStatus" jdbcType="TINYINT"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="channelCallbackTime" property="channelCallbackTime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <resultMap id="OrdersAmountVOMap" type="com.payment.trade.vo.OrdersAmountVO">
        <id column="o_id" property="ordersId" jdbcType="VARCHAR"/>
        <result column="o_amount" property="amount" jdbcType="DECIMAL"/>
        <result column="o_create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="p_product_id" property="productId" jdbcType="VARCHAR"/>
        <result column="p_product_currency" property="productCurrency" jdbcType="VARCHAR"/>
        <result column="d_name" property="dName" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="CalcInsOrdersAmountVOMap" type="com.payment.trade.vo.CalcInsOrdersAmountVO">
        <result column="productCode" property="productCode" jdbcType="INTEGER"/>
        <result column="productName" property="productName" jdbcType="VARCHAR"/>
        <collection property="calcDailyAmountVOList" resultMap="calcDailyAmountVOMap"/>
    </resultMap>

    <resultMap id="calcDailyAmountVOMap" type="com.payment.trade.vo.CalcDailyAmountVO">
        <result column="createTime" property="createTime" jdbcType="VARCHAR"/>
        <result column="dailyAmount" property="dailyAmount" jdbcType="DECIMAL"/>
    </resultMap>

    <resultMap id="CalcTotalAmountVOMap" type="com.payment.trade.vo.CalcTotalAmountVO">
        <result column="payTypeName" property="payTypeName" jdbcType="VARCHAR"/>
        <result column="totalAmount" property="totalAmount" jdbcType="DECIMAL"/>
    </resultMap>

    <resultMap id="CalcCurrencyAmountVOMap" type="com.payment.trade.vo.CalcCurrencyAmountVO">
        <result column="currency" property="currency" jdbcType="VARCHAR"/>
        <collection javaType="list" property="currencyAmountList" resultMap="CurrencyAmountVOMap"/>
    </resultMap>

    <resultMap id="CurrencyAmountVOMap" type="com.payment.trade.vo.CurrencyAmountVO">
        <result column="createTime" property="createTime" jdbcType="VARCHAR"/>
        <result column="totalAmount" property="totalAmount" jdbcType="DECIMAL"/>
    </resultMap>

    <resultMap id="PosSearchLogVOMap" type="com.payment.common.vo.PosSearchLogVO">
        <result column="payMethod" property="payMethod" jdbcType="VARCHAR"/>
        <collection javaType="list" property="posSearchVO" resultMap="PosSearchVOMap"/>
    </resultMap>


    <resultMap id="PosSearchVOMap" type="com.payment.common.vo.PosSearchVO">
        <id column="id" property="id" jdbcType="VARCHAR"/>
        <id column="institutionOrderId" property="institutionOrderId" jdbcType="VARCHAR"/>
        <result column="institutionCode" property="institutionCode" jdbcType="VARCHAR"/>
        <result column="deviceCode" property="deviceCode" jdbcType="VARCHAR"/>
        <result column="deviceOperator" property="deviceOperator" jdbcType="VARCHAR"/>
        <result column="tradeType" property="tradeType" jdbcType="VARCHAR"/>
        <result column="payMethod" property="payMethod" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="DECIMAL"/>
        <result column="createTime" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="orderCurrency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="count" property="count" jdbcType="INTEGER"/>
    </resultMap>

    <resultMap id="PosOrdersVOMap" type="com.payment.common.vo.PosOrdersVO">
        <id column="o_id" property="referenceNo" jdbcType="VARCHAR"/>
        <result column="o_institution_code" property="institutionId" jdbcType="VARCHAR"/>
        <result column="o_institution_name" property="institutionName" jdbcType="VARCHAR"/>
        <result column="o_institution_order_id" property="orderNo" jdbcType="VARCHAR"/>
        <result column="o_institution_order_time" property="orderTime" jdbcType="TIMESTAMP"/>
        <result column="o_amount" property="amount" jdbcType="DECIMAL"/>
        <result column="o_order_currency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="o_trade_type" property="tradeType" jdbcType="TINYINT"/>
        <result column="o_trade_status" property="txnstatus" jdbcType="TINYINT"/>
        <result column="o_refund_status" property="refundStatus" jdbcType="TINYINT"/>
        <result column="o_cancel_status" property="reverseStatus" jdbcType="TINYINT"/>
        <result column="o_device_code" property="terminalId" jdbcType="VARCHAR"/>
        <result column="o_device_operator" property="operatorId" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="payTypeName" property="payTypeName" jdbcType="VARCHAR"/>
        <result column="payTypeImgOne" property="payTypeImgOne" jdbcType="VARCHAR"/>
        <result column="payTypeImgTwo" property="payTypeImgTwo" jdbcType="VARCHAR"/>
        <result column="defaultValue" property="defaultValue" jdbcType="VARCHAR"/>
        <result column="productName" property="productName" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="OfflineOrdersVOMap" type="com.payment.common.vo.OfflineOrdersVO">
        <id column="referenceNo" property="referenceNo" jdbcType="VARCHAR"/>
        <result column="institutionId" property="institutionId" jdbcType="VARCHAR"/>
        <result column="institutionName" property="institutionName" jdbcType="VARCHAR"/>
        <result column="orderNo" property="orderNo" jdbcType="VARCHAR"/>
        <result column="orderTime" property="orderTime" jdbcType="TIMESTAMP"/>
        <result column="orderAmount" property="orderAmount" jdbcType="DECIMAL"/>
        <result column="orderCurrency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="tradeType" property="tradeType" jdbcType="TINYINT"/>
        <result column="txnstatus" property="txnstatus" jdbcType="TINYINT"/>
        <result column="refundStatus" property="refundStatus" jdbcType="TINYINT"/>
        <result column="reverseStatus" property="reverseStatus" jdbcType="TINYINT"/>
        <result column="txnTime" property="txnTime" jdbcType="TIMESTAMP"/>
        <result column="terminalId" property="terminalId" jdbcType="VARCHAR"/>
        <result column="operatorId" property="operatorId" jdbcType="VARCHAR"/>
        <result column="fee" property="fee" jdbcType="DECIMAL"/>
    </resultMap>

    <resultMap id="TradeVOMap" type="com.payment.trade.vo.TradeVO">
        <id column="orderId" property="id" jdbcType="VARCHAR"/>
        <result column="institutionCode" property="institutionCode" jdbcType="VARCHAR"/>
        <result column="institutionName" property="institutionName" jdbcType="VARCHAR"/>
        <result column="institutionOrderId" property="institutionOrderId" jdbcType="VARCHAR"/>
        <result column="tradeType" property="tradeType" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="VARCHAR"/>
        <result column="orderCurrency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="tradeAmount" property="tradeAmount" jdbcType="DECIMAL"/>
        <result column="tradeCurrency" property="tradeCurrency" jdbcType="VARCHAR"/>
        <result column="exchangeRate" property="exchangeRate" jdbcType="DECIMAL"/>
        <result column="createTime" property="createTime" jdbcType="VARCHAR"/>
        <result column="refundStatus" property="refundStatus" jdbcType="TINYINT"/>
        <result column="payMethod" property="payMethod" jdbcType="TINYINT"/>
        <result column="tradeStatus" property="tradeStatus" jdbcType="DECIMAL"/>
        <result column="cancelStatus" property="cancelStatus" jdbcType="TINYINT"/>
        <result column="channelCallbackTime" property="channelCallbackTime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <resultMap id="OnlineOrderInfoMap" type="com.payment.trade.vo.OnlineOrdersInfoVO">
        <id column="id" property="referenceNo" jdbcType="VARCHAR"/>
        <result column="institution_code" property="institutionId" jdbcType="VARCHAR"/>
        <result column="institution_name" property="institutionName" jdbcType="VARCHAR"/>
        <result column="institution_order_id" property="orderNo" jdbcType="VARCHAR"/>
        <result column="institution_order_time" property="orderTime" jdbcType="TIMESTAMP"/>
        <result column="amount" property="orderAmount" jdbcType="VARCHAR"/>
        <result column="order_currency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="fee" property="fee" jdbcType="DECIMAL"/>
        <result column="trade_status" property="txnstatus" jdbcType="DECIMAL"/>
        <result column="channel_callback_time" property="txnTime" jdbcType="TIMESTAMP"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="remark1" property="remark1" jdbcType="VARCHAR"/>
        <result column="remark2" property="remark2" jdbcType="VARCHAR"/>
        <result column="remark3" property="remark3" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="OrderTradeVOMap" type="com.payment.common.vo.OrderTradeVO">
        <id column="orderId" property="orderId" jdbcType="VARCHAR"/>
        <result column="institutionCode" property="institutionCode" jdbcType="VARCHAR"/>
        <result column="institutionName" property="institutionName" jdbcType="VARCHAR"/>
        <result column="institutionOrderId" property="institutionOrderId" jdbcType="VARCHAR"/>
        <result column="payMethod" property="payMethod" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="DECIMAL"/>
        <result column="orderCurrency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="productName" property="productName" jdbcType="VARCHAR"/>
        <result column="channelNumber" property="channelNumber" jdbcType="VARCHAR"/>
        <result column="tradeType" property="tradeType" jdbcType="VARCHAR"/>
        <result column="tradeDirection" property="tradeDirection" jdbcType="TINYINT"/>
        <result column="tradeAmount" property="tradeAmount" jdbcType="DECIMAL"/>
        <result column="tradeStatus" property="tradeStatus" jdbcType="TINYINT"/>
        <result column="cancelStatus" property="cancelStatus" jdbcType="TINYINT"/>
        <result column="refundStatus" property="refundStatus" jdbcType="TINYINT"/>
        <result column="exchangeRate" property="exchangeRate" jdbcType="DECIMAL"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="channelCallbackTime" property="channelCallbackTime" jdbcType="TIMESTAMP"/>
        <result column="reqIp" property="reqIp" jdbcType="VARCHAR"/>
        <result column="deviceCode" property="deviceCode" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap id="DccReportMap" type="com.payment.common.vo.DccReportVO">
        <result column="institutionCode" property="institutionCode" jdbcType="VARCHAR"/>
        <result column="institutionName" property="institutionName" jdbcType="VARCHAR"/>
        <result column="institutionOrderId" property="institutionOrderId" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="DECIMAL"/>
        <result column="orderCurrency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="tradeCurrency" property="tradeCurrency" jdbcType="VARCHAR"/>
        <result column="tradeAmount" property="tradeAmount" jdbcType="DECIMAL"/>
        <result column="exchangeRate" property="exchangeRate" jdbcType="DECIMAL"/>
        <result column="oldExchangeRate" property="oldExchangeRate" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="channelCallbackTime" property="channelCallbackTime" jdbcType="TIMESTAMP"/>
        <result column="tradeStatus" property="tradeStatus" jdbcType="TINYINT"/>
        <result column="channelName" property="channelName" jdbcType="VARCHAR"/>
        <result column="floatRate" property="floatRate" jdbcType="DECIMAL"/>
    </resultMap>

    <resultMap id="QueryAgencyTradeVOMap" type="com.payment.common.vo.QueryAgencyTradeVO">
        <result column="agencyCode" property="agencyCode" jdbcType="VARCHAR"/>
        <result column="institutionCode" property="institutionCode" jdbcType="VARCHAR"/>
        <result column="institutionName" property="institutionName" jdbcType="VARCHAR"/>
        <result column="amount" property="amount" jdbcType="DECIMAL"/>
        <result column="orderCurrency" property="orderCurrency" jdbcType="VARCHAR"/>
        <result column="tradeStatus" property="tradeStatus" jdbcType="TINYINT"/>
        <result column="createTime" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="remark" property="remark" jdbcType="DECIMAL"/>
        <result column="fee" property="fee" jdbcType="DECIMAL"/>
        <result column="id" property="id" jdbcType="VARCHAR"/>
    </resultMap>

    <sql id="Base_Column_List">
        id, trade_type, trade_direction,report_number,institution_code,return_url, institution_name, second_institution_name,language,
        second_institution_code, institution_order_time, institution_order_id, amount, order_currency,channel_number,channel_code,channel_name,
        commodity_name, product_code, product_name,device_code, device_operator, exchange_rate, exchange_time,
        exchange_status, trade_currency,
        report_channel_time,channel_callback_time,trade_amount, trade_status, rate_type, rate, fee, fee_payer,
        charge_status, clear_status,settle_status,
        float_rate,add_value,goods_description,drawee_name,drawee_account,drawee_bank,drawee_email,drawee_phone,sign,remark1,remark2,remark3,product_settle_cycle,
        charge_time, pay_method, req_ip,channel_fee,channel_fee_type,
        channel_rate,channel_gateway_rate,channel_gateway_fee,channel_gateway_fee_type,refund_status,cancel_status,
        channel_gateway_charge,channel_gateway_status,create_time,issuer_id,
        update_time, creator,modifier, remark,bank_name,remark4,up_channel_fee,agency_code
    </sql>

    <update id="updateOrderRemark">
        update orders
        set remark = #{msg}
        where id = #{referenceNo};
    </update>

    <select id="selectExport" resultMap="BaseResultMap">
        SELECT o.id,
        o.trade_type,
        o.trade_direction,
        o.institution_code,
        o.institution_name,
        o.second_institution_name,
        o.language,
        o.second_institution_code,
        o.institution_order_time,
        o.institution_order_id,
        o.amount,
        o.report_number,
        o.order_currency,
        o.channel_number,
        o.channel_code,
        o.channel_name,
        o.commodity_name,
        o.product_code,
        o.product_name,
        o.device_code,
        o.device_operator,
        o.exchange_rate,
        o.exchange_time,
        o.exchange_status,
        o.trade_currency,
        o.report_channel_time,
        o.channel_callback_time,
        o.trade_amount,
        o.trade_status,
        o.refund_status,
        o.cancel_status,
        o.rate_type,
        o.rate,
        o.fee,
        o.fee_payer,
        o.charge_status,
        o.clear_status,
        o.settle_status,
        o.float_rate,
        o.add_value,
        o.goods_description,
        o.drawee_name,
        o.drawee_account,
        o.drawee_bank,
        o.drawee_email,
        o.drawee_phone,
        o.sign,
        o.remark1,
        o.remark2,
        o.remark3,
        o.product_settle_cycle,
        o.charge_time,
        o.req_ip,
        o.channel_fee,
        o.channel_fee_type,
        o.channel_rate,
        o.channel_gateway_rate,
        o.channel_gateway_fee,
        o.channel_gateway_fee_type,
        o.channel_gateway_charge,
        o.channel_gateway_status,
        o.create_time,
        o.update_time,
        o.creator,
        o.bank_name,
        o.modifier,
        o.remark,
        d.name AS pay_method,
        d.id AS d_id
        FROM orders o,
        dictionary d
        WHERE o.pay_method = d.code
        and o.language = d.language
        <if test="language != null and language != ''">
            AND o.language = #{language}
        </if>
    </select>

    <select id="posGetOrders" resultMap="PosSearchLogVOMap">
        select
        p.institutionCode,p.deviceCode,p.deviceOperator,p.tradeType,p.payMethod,sum(p.amount) as
        amount,count(p.orderCurrency) as count,p.orderCurrency
        from
        ( SELECT o.institution_order_id as id ,o.institution_code as institutionCode ,o.device_code as
        deviceCode,o.device_operator as
        deviceOperator,o.create_time as createTime ,
        "1" as tradeType, c.issuer_id as payMethod ,o.amount as amount, o.order_currency as orderCurrency
        from orders o,channel c,dictionary di
        where o.trade_direction = 2 and o.channel_code = c.channel_code and di.code = 'dic_11_1' and o.trade_status = 3
        and di.`language` = #{language}
        <if test="institutionCode != null and institutionCode != ''">
            AND o.institution_code = #{institutionCode}
        </if>
        <if test="deviceOperator != null and deviceOperator != ''">
            AND o.device_operator = #{deviceOperator}
        </if>
        <if test="deviceCode != null and deviceCode != ''">
            AND o.device_code = #{deviceCode}
        </if>
        <if test="orderCurrency != null and orderCurrency != ''">
            AND o.order_currency = #{orderCurrency}
        </if>
        union
        SELECT r.institution_order_id as id ,r.institution_code as institutionCode ,r.device_code as
        deviceCode,r.device_operator as
        deviceOperator,r.create_time as createTime ,
        "2" as tradeType,c.issuer_id as payMethod ,r.amount as amount, r.order_currency as orderCurrency
        from order_refund r ,channel c,dictionary di
        where r.trade_direction = 2 and r.channel_code = c.channel_code and di.code = 'dic_11_3' and r.refund_status = 2
        and di.`language` = #{language}
        <if test="institutionCode != null and institutionCode != ''">
            AND r.institution_code = #{institutionCode}
        </if>
        <if test="deviceOperator != null and deviceOperator != ''">
            AND r.device_operator = #{deviceOperator}
        </if>
        <if test="deviceCode != null and deviceCode != ''">
            AND r.device_code = #{deviceCode}
        </if>
        <if test="orderCurrency != null and orderCurrency != ''">
            AND r.order_currency = #{orderCurrency}
        </if>
        ) as p
        <where>
            <if test="type != null and type != ''">
                AND p.tradeType = #{type}
            </if>
            <if test="startTime != null ">
                AND p.createTime >= #{startTime}
            </if>
            <if test="endTime != null ">
                AND #{endTime} >= p.createTime
            </if>
        </where>
        group by p.payMethod,p.orderCurrency,p.tradeType,p.institutionCode,p.deviceCode,p.deviceOperator

    </select>


    <select id="posGetOrdersDetail" resultMap="PosSearchVOMap">
        SELECT o.institution_order_id as id,o.institution_code as institutionCode ,o.device_code as
        deviceCode,o.device_operator as
        deviceOperator,o.create_time as createTime ,
        di.name as tradeType, c.issuer_id as payMethod ,o.amount as amount, o.order_currency as orderCurrency
        from orders o,channel c,dictionary di
        where o.trade_direction = 2 and o.channel_code = c.channel_code and di.code = 'dic_11_1' and o.trade_status = 3
        and di.`language` = #{language}
        <if test="institutionCode != null and institutionCode != ''">
            AND o.institution_code = #{institutionCode}
        </if>
        <if test="deviceOperator != null and deviceOperator != ''">
            AND o.device_operator = #{deviceOperator}
        </if>
        <if test="deviceCode != null and deviceCode != ''">
            AND o.device_code = #{deviceCode}
        </if>
        <if test="startTime != null ">
            AND o.create_time >= #{startTime}
        </if>
        <if test="endTime != null ">
            AND #{endTime} >= o.create_time
        </if>
        <if test="orderCurrency != null and orderCurrency != ''">
            AND o.order_currency = #{orderCurrency}
        </if>
        union
        SELECT r.institution_order_id as id,r.institution_code as institutionCode ,r.device_code as
        deviceCode,r.device_operator as
        deviceOperator,r.create_time as createTime ,
        di.name as tradeType,c.issuer_id as payMethod ,r.amount as amount, r.order_currency as orderCurrency
        from order_refund r ,channel c,dictionary di
        where r.trade_direction = 2 and r.channel_code = c.channel_code and di.code = 'dic_11_3' and r.refund_status = 2
        and di.`language` = #{language}
        <if test="institutionCode != null and institutionCode != ''">
            AND r.institution_code = #{institutionCode}
        </if>
        <if test="deviceOperator != null and deviceOperator != ''">
            AND r.device_operator = #{deviceOperator}
        </if>
        <if test="deviceCode != null and deviceCode != ''">
            AND r.device_code = #{deviceCode}
        </if>
        <if test="startTime != null ">
            AND r.create_time >= #{startTime}
        </if>
        <if test="endTime != null ">
            AND #{endTime} >= r.create_time
        </if>
        <if test="orderCurrency != null and orderCurrency != ''">
            AND r.order_currency = #{orderCurrency}
        </if>
    </select>


    <select id="calcOrdersAmount" resultMap="OrdersAmountVOMap">
        SELECT
        o.id as o_id,
        o.amount as o_amount,
        DATE_FORMAT(o.create_time,'%Y-%m-%d') as o_create_time,
        p.id as p_product_id,
        p.currency as p_product_currency,
        d.name as d_name
        FROM orders o,product p,dictionary d where o.product_code = p.product_code and p.pay_type = d.code
        and o.institution_code = #{institutionCode} and d.language = #{language}
        <if test="productCurrency != null and productCurrency != ''">
            AND p.currency = #{productCurrency}
        </if>
        <if test="productId != null and productId != ''">
            AND p.id = #{productId}
        </if>
        <if test="startDate != null ">
            AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &gt;= #{startDate}
        </if>
        <if test="endDate != null ">
            AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &lt;= #{endDate}
        </if>
    </select>


    <select id="selectByInstitutionOrderId" resultMap="BaseResultMap">
        SELECT <include refid="Base_Column_List"></include> FROM orders WHERE institution_order_id =
        #{institutionOrderId}
    </select>

    <select id="selectByInstitutionOrderIdAndStatus" resultMap="BaseResultMap">
        SELECT <include refid="Base_Column_List"></include> FROM orders
        WHERE institution_order_id = #{institutionOrderId} and trade_status = #{tradeStatus}
    </select>

    <select id="selectOrderByIdAndCode" resultMap="BaseResultMap">
        SELECT <include refid="Base_Column_List"></include> FROM orders WHERE institution_code = #{institutionCode} AND
        institution_order_id = #{institutionOrderId}
    </select>

    <select id="pageSelectMultipleConditions" resultMap="OrdersVOMap">
        SELECT
        o.institution_code as institutionCode,
        o.institution_order_id as institutionOrderId,
        o.amount as amount,
        o.order_currency as orderCurrency,
        o.trade_status as tradeStatus,
        o.refund_status as refundStatus,
        o.create_time as create_time,
        o.channel_callback_time as channelCallbackTime
        FROM orders o left join dictionary d on d.code = o.pay_method and d.language =#{language}
        <where>
            <if test="id != null and id != ''">
                AND o.id = #{id}
            </if>
            <if test="institutionOrderId != null and institutionOrderId != ''">
                AND o.institution_order_id = #{institutionOrderId}
            </if>
            <if test="institutionCode != null and institutionCode != ''">
                AND o.institution_code = #{institutionCode}
            </if>
            <if test="institutionName != null and institutionName != ''">
                AND o.institution_name LIKE CONCAT(CONCAT('%', #{institutionName}), '%')
            </if>
            <if test="channelNumber != null and channelNumber != ''">
                AND o.channel_number = #{channelNumber}
            </if>
            <if test="productCode != null and productCode != ''">
                AND o.product_code = #{productCode}
            </if>
            <if test="tradeStatus != null ">
                AND o.trade_status = #{tradeStatus}
            </if>
            <if test="orderCurrency != null and orderCurrency != ''">
                AND o.order_currency = #{orderCurrency}
            </if>
            <if test="startDate != null and startDate != ''">
                AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &gt;= #{startDate}
            </if>
            <if test="endDate != null and endDate != ''">
                AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &lt;= #{endDate}
            </if>
            <if test="payMethod != null and payMethod != ''">
                AND o.pay_method = #{payMethod}
            </if>
            <if test="tradeType != null">
                AND o.trade_type = #{tradeType}
            </if>
            <if test="tradeDirection != null and tradeDirection != ''">
                AND o.trade_direction = #{tradeDirection}
            </if>
        </where>
    </select>


    <select id="getTradeDetail" resultMap="TradeDetailMap">
        SELECT o.create_time,
               o.institution_order_id,
               o.id,
               o.order_currency,
               o.amount,
               o.fee,
               o.add_value,
               o.req_ip,
               o.device_code,
               o.device_operator,
               o.trade_status,
               o.req_ip,
               o.exchange_time,
               o.trade_amount,
               o.trade_currency,
               o.product_name,
               o.float_rate,
               o.exchange_rate,
               o.exchange_status,
               o.report_channel_time,
               o.channel_number,
               o.channel_name,
               o.drawee_name,
               o.drawee_account,
               o.drawee_bank,
               o.drawee_email,
               o.channel_callback_time,
               o.remark,
               o.remark1,
               o.remark2,
               o.remark3,
               o.remark4,
               o.fee_payer,
               o.bank_name,
               o.issuer_id,
               dd.name                 as rate_type,
               ore.create_time         as ore_create_time,
               ore.id                  as ore_id,
               ore.amount              as ore_amount,
               ore.exchange_rate       as ore_exchange_rate,
               ore.trade_amount        as ore_trade_amount,
               ore.trade_currency      as ore_trade_currency,
               ore.channel_name        as ore_channel_name,
               ore.refund_status       as ore_refund_status,
               ore.remark              as ore_remark,
               ore.update_time         as ore_update_time,
               d.name                  as d_name,
               ol.id                   as ol_id,
               ol.reference_no         as ol_reference_no,
               ol.institution_code     as ol_institution_code,
               ol.institution_name     as ol_institution_name,
               ol.institution_order_id as ol_institution_order_id,
               ol.product_description  as ol_product_description,
               ol.invoice_no           as ol_invoice_no,
               ol.provider_name        as ol_provider_name,
               ol.payer_address        as ol_payer_address,
               ol.payer_name           as ol_payer_name,
               ol.payer_email          as ol_payer_email,
               ol.delivery_status      as ol_delivery_status,
               ol.received_status      as ol_received_status,
               ol.create_time          as ol_create_time,
               ol.update_time          as ol_update_time,
               ol.creator              as ol_creator,
               ol.modifier             as ol_modifier,
               ol.remark               as ol_remark
        FROM orders o
                 left join order_refund ore on o.id = ore.order_id
                 left join dictionary d on d.code = o.pay_method and d.language = #{language}
                 left join dictionary dd on dd.code = o.rate_type
                 left join order_logistics ol on o.id = ol.reference_no
        WHERE o.id = #{id}
    </select>

    <select id="selectById" resultMap="BaseResultMap" resultType="com.payment.common.entity.Orders">
        select
        <include refid="Base_Column_List"/>
        from orders
        where id = #{orderId};
    </select>


    <select id="pageGetOrdersInfo" resultMap="PosOrdersVOMap">
        SELECT
        o.id as o_id,
        o.institution_code as o_institution_code,
        o.institution_name as o_institution_name,
        o.institution_order_id as o_institution_order_id,
        o.institution_order_time as o_institution_order_time,
        o.pay_method as o_pay_method,
        o.language as o_language,
        o.amount as o_amount,
        o.order_currency as o_order_currency,
        o.exchange_rate as o_exchange_rate,
        o.trade_currency as o_trade_currency,
        o.trade_type as o_trade_type,
        o.trade_amount as o_trade_amount,
        o.trade_status as o_trade_status,
        o.refund_status as o_refund_status,
        o.cancel_status as o_cancel_status,
        o.create_time as create_time,
        o.channel_callback_time as o_channel_callback_time,
        o.device_code as o_device_code,
        o.device_operator as o_device_operator,
        o.fee as o_fee,
        o.add_value as o_add_value,
        d.name as payTypeName,
        dd.default_value as defaultValue,
        p.icon as payTypeImgOne,
        d.icon as payTypeImgTwo,
        d.create_time as d_create_time,
        concat(d.name,'-',o.order_currency) as productName
        FROM orders o left join dictionary d on d.code = o.pay_method and d.language = #{language}
        left join dictionary dd on o.order_currency = dd.`code`
        left join payment_mode p on o.pay_method = p.pay_type
        <where>
            <if test="referenceNo != null and referenceNo != ''">
                AND o.id = #{referenceNo}
            </if>
            <if test="institutionId != null and institutionId != ''">
                AND o.institution_code = #{institutionId}
            </if>
            <if test="terminalId != null and terminalId != ''">
                AND o.device_code = #{terminalId}
            </if>
            <if test="operatorId != null and operatorId != ''">
                AND o.device_operator =#{operatorId}
            </if>
            <if test="txnstatus != null">
                AND o.trade_status = #{txnstatus}
            </if>
            <if test="refundStatus != null">
                AND o.refund_status = #{refundStatus}
            </if>
            <if test="startDate != null and startDate != ''">
                AND o.create_time &gt;= #{startDate}
            </if>
            <if test="endDate != null  and endDate != ''">
                AND o.create_time &lt;= #{endDate}
            </if>
        </where>
        order by o.create_time desc
    </select>

    <select id="pageOfflineOrdersInfo" resultMap="OfflineOrdersVOMap">
        SELECT
        id as referenceNo,
        institution_code as institutionId,
        institution_name as institutionName,
        institution_order_id as orderNo,
        institution_order_time as orderTime,
        amount as orderAmount,
        order_currency as orderCurrency,
        trade_type as tradeType,
        trade_status as txnstatus,
        refund_status as refundStatus,
        cancel_status as reverseStatus,
        channel_callback_time as txnTime,
        device_code as terminalId,
        device_operator as operatorId,
        fee as fee
        FROM orders
        <where>
            <if test="referenceNo != null and referenceNo != ''">
                AND id = #{referenceNo}
            </if>
            <if test="institutionId != null and institutionId != ''">
                AND institution_code = #{institutionId}
            </if>
            <if test="terminalId != null and terminalId != ''">
                AND device_code = #{terminalId}
            </if>
            <if test="operatorId != null and operatorId != ''">
                AND device_operator =#{operatorId}
            </if>
            <if test="txnstatus != null">
                AND trade_status = #{txnstatus}
            </if>
            <if test="refundStatus != null">
                AND refund_status = #{refundStatus}
            </if>
            <if test="startDate != null and startDate != ''">
                AND DATE_FORMAT(create_time,'%Y-%m-%d') &gt;= #{startDate}
            </if>
            <if test="endDate != null  and endDate != ''">
                AND DATE_FORMAT(create_time,'%Y-%m-%d') &lt;= #{endDate}
            </if>
        </where>
    </select>

    <select id="pagePosGetOrdersInfo" resultMap="PosOrdersVOMap">
        SELECT
        o.id as o_id,
        o.institution_code as o_institution_code,
        o.institution_name as o_institution_name,
        o.institution_order_id as o_institution_order_id,
        o.institution_order_time as o_institution_order_time,
        o.pay_method as o_pay_method,
        o.language as o_language,
        o.amount as o_amount,
        o.order_currency as o_order_currency,
        o.exchange_rate as o_exchange_rate,
        o.trade_currency as o_trade_currency,
        o.trade_type as o_trade_type,
        o.trade_amount as o_trade_amount,
        o.trade_status as o_trade_status,
        o.refund_status as o_refund_status,
        o.cancel_status as o_cancel_status,
        o.create_time as create_time,
        o.channel_callback_time as o_channel_callback_time,
        o.device_code as o_device_code,
        o.device_operator as o_device_operator,
        o.fee as o_fee,
        o.add_value as o_add_value,
        d.name as payTypeName,
        dd.default_value as defaultValue,
        p.icon as payTypeImgOne,
        d.icon as payTypeImgTwo,
        d.create_time as d_create_time,
        concat(d.name,'-',o.order_currency) as productName
        FROM orders o left join dictionary d on d.code = o.pay_method and d.language = #{language}
        left join dictionary dd on o.order_currency = dd.`code`
        left join payment_mode p on o.pay_method = p.pay_type
        <where>
            <if test="referenceNo != null and referenceNo != ''">
                AND o.id = #{referenceNo}
            </if>
            <if test="institutionId != null and institutionId != ''">
                AND o.institution_code = #{institutionId}
            </if>
            <if test="terminalId != null and terminalId != ''">
                AND o.device_code = #{terminalId}
            </if>
            <if test="operatorId != null and operatorId != ''">
                AND o.device_operator =#{operatorId}
            </if>
            <if test="txnstatus != null">
                AND o.trade_status = #{txnstatus}
            </if>
            <if test="refundStatus == null">
                AND o.refund_status is null
            </if>
            <if test="refundStatus != null">
                AND o.refund_status = #{refundStatus}
            </if>
            <if test="startDate != null and startDate != ''">
                AND o.create_time &gt;= #{startDate}
            </if>
            <if test="endDate != null  and endDate != ''">
                AND o.create_time &lt;= #{endDate}
            </if>
        </where>
        order by o.create_time desc
    </select>

    <select id="pageGetAllOrdersInfo" resultMap="OrderTradeVOMap">
        SELECT
        o.id AS orderId,
        o.institution_code AS institutionCode,
        o.institution_name AS institutionName,
        o.institution_order_id AS institutionOrderId,
        o.trade_type AS tradeType,
        o.amount AS amount,
        o.order_currency AS orderCurrency,
        o.trade_amount AS tradeAmount,
        o.trade_currency AS tradeCurrency,
        o.exchange_rate AS exchangeRate,
        o.create_time AS create_time,
        d.name AS payMethod,
        concat(d.name,'-',o.trade_currency) AS productName,
        o.trade_status AS tradeStatus,
        o.cancel_status as cancelStatus,
        o.refund_status as refundStatus,
        o.channel_number AS channelNumber,
        o.product_code AS productCode,
        o.trade_direction AS tradeDirection,
        o.channel_callback_time AS channelCallbackTime,
        o.req_ip AS reqIp,
        o.device_code AS deviceCode
        FROM orders o LEFT JOIN dictionary d on o.pay_method = d.`code`AND d.`language`= #{language}
        <where>
            <if test="id != null and id != ''">
                AND o.id = #{id}
            </if>
            <if test="institutionOrderId != null and institutionOrderId != ''">
                AND o.institution_order_id = #{institutionOrderId}
            </if>
            <if test="institutionCode != null and institutionCode != ''">
                AND o.institution_code = #{institutionCode}
            </if>
            <if test="institutionName != null and institutionName != ''">
                AND o.institution_name LIKE CONCAT(CONCAT('%', #{institutionName}), '%')
            </if>
            <if test="channelNumber != null and channelNumber != ''">
                AND o.channel_number = #{channelNumber}
            </if>
            <if test="productCode != null and productCode != ''">
                AND o.product_code = #{productCode}
            </if>
            <if test="tradeStatus != null">
                AND o.trade_status = #{tradeStatus}
            </if>
            <if test="cancelStatus != null">
                AND o.cancel_status = #{cancelStatus}
            </if>
            <if test="refundStatus != null">
                AND o.refund_status = #{refundStatus}
            </if>
            <if test="orderCurrency != null and orderCurrency != ''">
                AND o.order_currency = #{orderCurrency}
            </if>
            <if test="startDate != null and startDate != ''">
                AND o.create_time &gt;= #{startDate}
            </if>
            <if test="endDate != null and endDate != ''">
                AND o.create_time &lt;= #{endDate}
            </if>
            <if test="startPayFinishTime != null and startPayFinishTime != ''">
                AND o.channel_callback_time &gt;= #{startPayFinishTime}
            </if>
            <if test="endPayFinishTime != null and endPayFinishTime != ''">
                AND o.channel_callback_time &lt;= #{endPayFinishTime}
            </if>
            <if test="tradeType != null and tradeType != ''">
                AND o.trade_type = #{tradeType}
            </if>
            <if test="tradeDirection != null">
                AND o.trade_direction = #{tradeDirection}
            </if>
        </where>
    </select>

    <select id="exportAllOrdersInfo" resultType="com.payment.common.vo.OrderTradeVO">
        SELECT
        o.id AS orderId,
        o.institution_code AS institutionCode,
        o.institution_name AS institutionName,
        o.institution_order_id AS institutionOrderId,
        o.trade_type AS tradeType,
        o.amount AS amount,
        o.order_currency AS orderCurrency,
        o.trade_amount AS tradeAmount,
        o.trade_currency AS tradeCurrency,
        o.exchange_rate AS exchangeRate,
        o.create_time AS createTime,
        d.name AS payMethod,
        concat(d.name,'-',o.trade_currency) AS productName,
        o.trade_status AS tradeStatus,
        o.cancel_status as cancelStatus,
        o.refund_status as refundStatus,
        o.channel_name AS channelName,
        o.channel_number AS channelNumber,
        o.product_code AS productCode,
        o.trade_direction AS tradeDirection,
        o.channel_callback_time AS channelCallbackTime,
        o.fee AS fee,
        o.req_ip AS reqIp,
        o.product_name AS goodsName,
        o.device_code AS deviceCode,
        o.drawee_name AS draweeName,
        o.drawee_email AS draweeEmail,
        o.remark AS remark
        FROM orders o LEFT JOIN dictionary d on o.pay_method = d.`code`AND d.`language`= #{language}
        <where>
            <if test="id != null and id != ''">
                AND o.id = #{id}
            </if>
            <if test="institutionOrderId != null and institutionOrderId != ''">
                AND o.institution_order_id = #{institutionOrderId}
            </if>
            <if test="institutionCode != null and institutionCode != ''">
                AND o.institution_code = #{institutionCode}
            </if>
            <if test="institutionName != null and institutionName != ''">
                AND o.institution_name LIKE CONCAT(CONCAT('%', #{institutionName}), '%')
            </if>
            <if test="channelNumber != null and channelNumber != ''">
                AND o.channel_number = #{channelNumber}
            </if>
            <if test="productCode != null and productCode != ''">
                AND o.product_code = #{productCode}
            </if>
            <if test="tradeStatus != null">
                AND o.trade_status = #{tradeStatus}
            </if>
            <if test="cancelStatus != null">
                AND o.cancel_status = #{cancelStatus}
            </if>
            <if test="refundStatus != null">
                AND o.refund_status = #{refundStatus}
            </if>
            <if test="orderCurrency != null and orderCurrency != ''">
                AND o.order_currency = #{orderCurrency}
            </if>
            <if test="startDate != null and startDate != ''">
                AND o.create_time &gt;= #{startDate}
            </if>
            <if test="endDate != null and endDate != ''">
                AND o.create_time &lt;= #{endDate}
            </if>
            <if test="tradeType != null and tradeType != ''">
                AND o.trade_type = #{tradeType}
            </if>
            <if test="tradeDirection != null">
                AND o.trade_direction = #{tradeDirection}
            </if>
            <if test="startPayFinishTime != null and startPayFinishTime != ''">
                AND o.channel_callback_time &gt;= #{startPayFinishTime}
            </if>
            <if test="endPayFinishTime != null and endPayFinishTime != ''">
                AND o.channel_callback_time &lt;= #{endPayFinishTime}
            </if>
        </where>
        order by o.create_time desc
    </select>

    <select id="selectOrderByInstitutionOrderId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from orders where institution_order_id = #{institutionOrderId} ORDER BY create_time DESC LIMIT 1;
    </select>


    <select id="calcInsOrdersDailyAmount" resultMap="CalcInsOrdersAmountVOMap">
        SELECT
        o.product_code as productCode,
        DATE_FORMAT(o.create_time, '%Y-%m-%d') AS createTime,
        concat(d. NAME, '-', o.order_currency) AS productName,
        sum(o.amount) AS dailyAmount
        FROM
        orders o,
        product p,
        dictionary d
        WHERE
        o.product_code = p.product_code
        AND o.pay_method = d. CODE
        AND d. LANGUAGE = #{language}
        AND o.institution_code = #{institutionCode}
        AND o.trade_status= 3
        <if test="productCurrency != null and productCurrency != ''">
            AND o.order_currency = #{productCurrency}
        </if>
        <if test="startDate != null and startDate !=''">
            AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &gt;= #{startDate}
        </if>
        <if test="endDate != null and endDate !=''">
            AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &lt;= #{endDate}
        </if>
        GROUP BY
        DATE_FORMAT(o.create_time, '%Y-%m-%d'),o.product_code
    </select>

    <select id="calcInsOrdersTotalAmount" resultMap="CalcTotalAmountVOMap">
        SELECT
        d.name as payTypeName,
        sum(o.amount) AS totalAmount
        FROM orders o ,dictionary d
        where o.pay_method = d.`code` and d.`language` = #{language}
        AND o.institution_code = #{institutionCode}
        <if test="productCurrency != null and productCurrency != ''">
            AND o.order_currency = #{productCurrency}
        </if>
        <if test="startDate != null and startDate !=''">
            AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &gt;= #{startDate}
        </if>
        <if test="endDate != null and endDate !=''">
            AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &lt;= #{endDate}
        </if>
        AND o.trade_status = 3
        GROUP BY o.pay_method
    </select>

    <select id="selectCurrencyTotalAmount" resultMap="CalcCurrencyAmountVOMap">
        SELECT
        o.order_currency AS currency,
        sum(o.amount) AS totalAmount,
        DATE_FORMAT(o.create_time, '%Y-%m-%d') AS createTime
        FROM orders o WHERE o.institution_code = #{institutionCode}
        <if test="productCurrency != null and productCurrency != ''">
            AND o.order_currency = #{productCurrency}
        </if>
        <if test="startDate != null and startDate !=''">
            AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &gt;= #{startDate}
        </if>
        <if test="endDate != null and endDate !=''">
            AND DATE_FORMAT(o.create_time,'%Y-%m-%d') &lt;= #{endDate}
        </if>
        AND o.trade_status = 3
        GROUP BY o.order_currency, DATE_FORMAT(o.create_time, '%Y-%m-%d')
    </select>

    <select id="pageOnlineOrderInfo" resultMap="OnlineOrderInfoMap">
        select o.id,
        institution_code,
        institution_name,
        institution_order_time,
        institution_order_id,
        amount,
        order_currency,
        trade_currency,
        trade_amount,
        trade_status,
        refund_status,
        rate_type,
        rate,
        fee,
        o.create_time,
        channel_callback_time,
        remark1,
        remark2,
        remark3,
        d.name as pay_method_name
        from orders o left join dictionary d on o.pay_method = d.code and d.language = #{language}
        where o.trade_direction = 1 AND institution_code = #{institutionId}
        <if test="txnstatus != null">
            AND trade_status = #{txnstatus}
        </if>
        <if test="orderNo !=null">
            and institution_order_id = #{orderNo}
        </if>
        <if test="startDate != null ">
            AND o.institution_order_time >= #{startDate}
        </if>
        <if test="endDate != null ">
            AND #{endDate} >= o.institution_order_time
        </if>
        <if test="orderCurrency != null and orderCurrency != ''">
            AND order_currency = #{orderCurrency}
        </if>
        order by o.create_time DESC
    </select>


    <select id="terminalQueryOrderDetail" resultMap="PosOrdersVOMap">
        SELECT o.id as o_id,
        o.institution_code as o_institution_code,
        o.institution_name as o_institution_name,
        o.institution_order_id as o_institution_order_id,
        o.institution_order_time as o_institution_order_time,
        o.pay_method as o_pay_method,
        o.language as o_language,
        o.amount as o_amount,
        o.order_currency as o_order_currency,
        o.exchange_rate as o_exchange_rate,
        o.trade_currency as o_trade_currency,
        o.trade_type as o_trade_type,
        o.trade_amount as o_trade_amount,
        o.trade_status as o_trade_status,
        o.refund_status as o_refund_status,
        o.cancel_status as o_cancel_status,
        o.create_time as create_time,
        o.channel_callback_time as o_channel_callback_time,
        o.device_code as o_device_code,
        o.device_operator as o_device_operator,
        o.fee as o_fee,
        o.add_value as o_add_value,
        d.name as payTypeName,
        dd.default_value as defaultValue,
        d.create_time as d_create_time,
        concat(d.name, '-', o.order_currency) as productName,
        d.icon as payTypeImgTwo,
        p.icon as payTypeImgOne
        FROM orders o
        left join dictionary d on d.code = o.pay_method and d.language = #{language}
        left join dictionary dd on o.order_currency = dd.`code`
        left join payment_mode p on o.pay_method = p.pay_type
        <where>
            <if test="institutionId != null and institutionId != ''">
                AND o.institution_code = #{institutionId}
            </if>
            <if test="orderNo != null and orderNo != ''">
                AND o.institution_order_id = #{orderNo}
            </if>
            <if test="terminalId != null and terminalId != ''">
                AND o.device_code = #{terminalId}
            </if>
            <if test="operatorId != null and operatorId != ''">
                AND o.device_operator =#{operatorId}
            </if>
        </where>
        order by o.create_time desc
    </select>

    <select id="exportInstitutionOrders" resultType="com.payment.common.vo.InstitutionOrderTradeVO">
        SELECT
        o.id AS orderId,
        o.institution_code AS institutionCode,
        o.institution_name AS institutionName,
        o.institution_order_id AS institutionOrderId,
        o.trade_type AS tradeType,
        o.amount AS amount,
        o.order_currency AS orderCurrency,
        o.create_time AS createTime,
        d.name AS payMethod,
        concat(d.name,'-',o.order_currency) AS productName,
        o.trade_status AS tradeStatus,
        o.cancel_status as cancelStatus,
        o.refund_status as refundStatus,
        o.channel_number AS channelNumber,
        o.product_code AS productCode,
        o.trade_direction AS tradeDirection,
        o.channel_callback_time AS channelCallbackTime,
        o.fee AS fee,
        o.device_code AS deviceCode
        FROM orders o LEFT JOIN dictionary d on o.pay_method = d.`code`AND d.`language`= #{language}
        <where>
            <if test="id != null and id != ''">
                AND o.id = #{id}
            </if>
            <if test="institutionOrderId != null and institutionOrderId != ''">
                AND o.institution_order_id = #{institutionOrderId}
            </if>
            <if test="institutionCode != null and institutionCode != ''">
                AND o.institution_code = #{institutionCode}
            </if>
            <if test="channelNumber != null and channelNumber != ''">
                AND o.channel_number = #{channelNumber}
            </if>
            <if test="productCode != null and productCode != ''">
                AND o.product_code = #{productCode}
            </if>
            <if test="tradeStatus != null">
                AND o.trade_status = #{tradeStatus}
            </if>
            <if test="cancelStatus != null">
                AND o.cancel_status = #{cancelStatus}
            </if>
            <if test="refundStatus != null">
                AND o.refund_status = #{refundStatus}
            </if>
            <if test="orderCurrency != null and orderCurrency != ''">
                AND o.order_currency = #{orderCurrency}
            </if>
            <if test="startDate != null and startDate != ''">
                AND o.create_time &gt;= #{startDate}
            </if>
            <if test="endDate != null and endDate != ''">
                AND o.create_time &lt;= #{endDate}
            </if>
            <if test="tradeType != null and tradeType != ''">
                AND o.trade_type = #{tradeType}
            </if>
            <if test="tradeDirection != null">
                AND o.trade_direction = #{tradeDirection}
            </if>
            <if test="startPayFinishTime != null and startPayFinishTime != ''">
                AND o.channel_callback_time &gt;= #{startPayFinishTime}
            </if>
            <if test="endPayFinishTime != null and endPayFinishTime != ''">
                AND o.channel_callback_time &lt;= #{endPayFinishTime}
            </if>
        </where>
        order by o.create_time desc
    </select>


    <select id="pageDccReport" resultMap="DccReportMap">
        select create_time as createTime,
        institution_code as institutionCode,
        institution_name as institutionName,
        institution_order_id as institutionOrderId,
        id as id,
        order_currency as orderCurrency,
        amount as amount,
        trade_amount as tradeAmount,
        trade_currency as tradeCurrency,
        exchange_rate as exchangeRate,
        commodity_name as oldExchangeRate,
        float_rate as floatRate,
        channel_name as channelName,
        channel_callback_time as channelCallbackTime,
        trade_status as tradeStatus from orders where trade_status = 3
        <if test="id != null and id != ''">
            AND id = #{id}
        </if>
        <if test="institutionOrderId != null and institutionOrderId != ''">
            AND institution_order_id = #{institutionOrderId}
        </if>
        <if test="institutionCode != null and institutionCode != ''">
            AND institution_code = #{institutionCode}
        </if>
        <if test="institutionName != null and institutionName != ''">
            AND institution_name LIKE CONCAT(CONCAT('%', #{institutionName}), '%')
        </if>
        <if test="orderCurrency != null and orderCurrency != ''">
            AND order_currency = #{orderCurrency}
        </if>
        <if test="startDate != null and startDate != ''">
            AND create_time &gt;= #{startDate}
        </if>
        <if test="endDate != null and endDate != ''">
            AND create_time &lt;= #{endDate}
        </if>
    </select>

    <select id="exportDccReport" resultMap="DccReportMap">
        select create_time as createTime,
        institution_code as institutionCode,
        institution_name as institutionName,
        institution_order_id as institutionOrderId,
        id as id,
        order_currency as orderCurrency,
        amount as amount,
        trade_amount as tradeAmount,
        trade_currency as tradeCurrency,
        exchange_rate as exchangeRate,
        commodity_name as oldExchangeRate,
        float_rate as floatRate,
        channel_name as channelName,
        channel_callback_time as channelCallbackTime,
        trade_status as tradeStatus from orders where trade_status = 3
        <if test="id != null and id != ''">
            AND id = #{id}
        </if>
        <if test="institutionOrderId != null and institutionOrderId != ''">
            AND institution_order_id = #{institutionOrderId}
        </if>
        <if test="institutionCode != null and institutionCode != ''">
            AND institution_code = #{institutionCode}
        </if>
        <if test="institutionName != null and institutionName != ''">
            AND institution_name LIKE CONCAT(CONCAT('%', #{institutionName}), '%')
        </if>
        <if test="orderCurrency != null and orderCurrency != ''">
            AND order_currency = #{orderCurrency}
        </if>
        <if test="startDate != null and startDate != ''">
            AND create_time &gt;= #{startDate}
        </if>
        <if test="endDate != null and endDate != ''">
            AND create_time &lt;= #{endDate}
        </if>
    </select>

    <select id="pageAgencyTrade" resultMap="QueryAgencyTradeVOMap">
        SELECT
        create_time AS createTime,
        agency_code AS agencyCode,
        institution_name AS institutionName,
        institution_code AS institutionCode,
        fee AS fee,
        id AS id,
        order_currency AS orderCurrency,
        amount AS amount,
        remark AS remark,
        trade_status AS tradeStatus FROM orders
        where agency_code =#{agencyCode}
        <if test="id != null and id != ''">
            AND id = #{id}
        </if>
        <if test="institutionCode != null and institutionCode != ''">
            AND institution_code = #{institutionCode}
        </if>
        <if test="institutionName != null and institutionName != ''">
            AND institution_name LIKE CONCAT(CONCAT('%', #{institutionName}), '%')
        </if>
        <if test="startDate != null and startDate != ''">
            AND create_time &gt;= #{startDate}
        </if>
        <if test="endDate != null  and endDate != ''">
            AND create_time &lt;= #{endDate}
        </if>
    </select>

    <select id="exportAgencyTrade" resultMap="QueryAgencyTradeVOMap">
        SELECT
        create_time AS createTime,
        agency_code AS agencyCode,
        institution_name AS institutionName,
        institution_code AS institutionCode,
        fee AS fee,
        id AS id,
        order_currency AS orderCurrency,
        amount AS amount,
        remark AS remark,
        trade_status AS tradeStatus FROM orders
        where agency_code =#{agencyCode}
        <if test="id != null and id != ''">
            AND id = #{id}
        </if>
        <if test="institutionCode != null and institutionCode != ''">
            AND institution_code = #{institutionCode}
        </if>
        <if test="institutionName != null and institutionName != ''">
            AND institution_name LIKE CONCAT(CONCAT('%', #{institutionName}), '%')
        </if>
        <if test="startDate != null and startDate != ''">
            AND create_time &gt;= #{startDate}
        </if>
        <if test="endDate != null  and endDate != ''">
            AND create_time &lt;= #{endDate}
        </if>
        order by create_time desc
    </select>

</mapper>
